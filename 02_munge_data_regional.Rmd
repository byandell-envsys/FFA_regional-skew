---
title: "Get peak flow data for Northwestern Great Plains ecoregion gages"
author: "CJ Tinant"
date: "`r Sys.Date()`"
output: html_document
---

<!--

## Next steps
* shapefile to sp class for level 3 ecoregion
* intersect level 3 ecoregion with station data

## Helpful references:
GIT issues--
[GIT issues](https://dangitgit.com/)

Spatial data issues--
[Intro to spatial data in R](https://www.r4wrds.com/intro/m_intro_mapmaking)
[Overview of Coordinate Reference Systems (CRS) in R](https://www.nceas.ucsb.edu/sites/default/files/2020-04/OverviewCoordinateReferenceSystems.pdf)
[Geocomputation with R](https://r.geocompx.org/)

--> 

```{r 00_setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)

# library
library(tidyverse)        # Load the 'Tidyverse' packages: ggplot2, dplyr, 
                          #   tidyr, readr, purrr, tibble, stringr, and forcats
library(dataRetrieval)    # Retrieval functions for USGS and EPA hydrology and
                          #   water quality data
library(sf)               # Simple features for R

```

```{r 01_import_peak_sites, eval=FALSE}

sites_peak <- read_csv("data/sites_peak_all.csv")
sites_peak_gt_20 <- read_csv("data/sites_peak_gt_20.csv")

```

```{r 02_convert_df_to_spatial_format}

# get datum 
datum_sites <- sites_peak_gt_20 %>%
  select(dec_coord_datum_cd) %>%
  distinct()

datum_sites <- datum_sites$dec_coord_datum_cd

# convert stations into a spatial format (sf) object
sites_peak_gt_20 <- st_as_sf(sites_peak_gt_20,
                    coords = c("dec_long_va",        # note x goes first
                                "dec_lat_va"),
                    crs = 4269,                     # projection, this is NAD83
                    remove = FALSE)                 # don't remove lat/lon cols

# quick plot of the geometry
plot(sites_peak_gt_20)

```

