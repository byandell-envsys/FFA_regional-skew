data_pk_flags <- left_join(data_pk_flags, desc_peak_flag,
by = join_by(peak_cd))
rm(desc_peak_flag)
# find percentage of obs with regulation
n_records <- nrow(data_pk_gt_20)
data_pk_flags <- data_pk_flags %>%
mutate(total_obs = n_records) %>%
mutate(percent_obs = 100 * count / total_obs)
# pull records with dam fail, regulation, or discharge otherwise affected
data_regulated <- data_gt_20 %>%
filter(peak_cd == "3" |
peak_cd == "5" |
peak_cd == "6" |
peak_cd == "C"
)
# keep remaining unregulated observations
data_unregulated <- anti_join(data_gt_20, data_regulated)
# check that the count is true
check_count <- nrow(data_gt_20) == nrow(data_regulated) + nrow(data_unregulated)
# ---------------------------------------------------------
# get initial set of unregulated sites
sites_unreg <-sites_gt_20 %>%
filter(site_no %in% data_unregulated$site_no)
# get a new count of years in the unregulated data
ck_count <- data_unregulated %>%
group_by(site_no) %>%
summarise(count_nu_new = n())
sites_unreg <- left_join(sites_unreg, ck_count,
by = join_by(site_no)
) %>%
arrange(count_nu_new)
sites_unreg_gt_20 <- sites_unreg %>%
filter(count_nu_new >= 20)
View(sites_unreg)
View(sites_unreg_gt_20)
ck_sites <- anti_join(sites_gt_20, sites_unreg_gt_20)
sites_regulated <- anti_join(sites_gt_20, sites_unreg_gt_20)
rm(ck_count)
rm(ck_sites)
sites_reg_or_lt_20 <- anti_join(sites_gt_20, sites_unreg_gt_20)
rm(sites_regulated)
data_unreg_gt_20 <- data_unregulated %>%
filter(site_no %in% sites_unreg_gt_20$site_no)
ck_final_ave_yr <- nrow(data_unreg_gt_20/sites_unreg_gt_20)
ck_final_ave_yr <- nrow(data_unreg_gt_20) / nrow(sites_unreg_gt_20)
View(sites_unreg_gt_20)
# export data
write_csv(sites_unreg_gt_20, "data/sites_pk_unreg_gt_20.csv")
write_csv(data_unreg_gt_20, "data/data_pk_unreg_gt_20.csv")
write_csv(sites_reg_or_lt_20, "data/sites_reg_or_lt_20.csv")
knitr::opts_chunk$set(echo = TRUE)
# libraries
library(tidyverse)      # Load 'Tidyverse' packages: ggplot2, dplyr, tidyr,
#                                 readr, purrr, tibble, stringr, forcats
library(glue)           # For string interpolation
library(here)           # A simpler way to find files
# get gages in GP ecoregion with gt 20 yrs of unregulated streamflow data
gages_eco <- read_csv("data/sites_pk_eco_only.csv")
rm(list = ls(pattern = "data"))
gages_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
rm(list = ls(pattern = "sites_eco_only"))
rm(list = ls(pattern = "sites_gt_20"))
library(dataRetrieval)  # Retrieval functions for USGS and EPA hydro & wq data
# =======================
# Purpose:
# This script obtains peak flow gage data.
#
# Steps:
# 1) Get peak flow sites in Great Plains ecoregion from local memory
# 2) Remove sites with less than 20 years obs
# 3) Get observations (data) of remaining sites
# 4) Remove observations affected by regulation or diversion
# 5) Remove remaining sites with less than 20 yrs obs
#
# =======================
# ---------------------------------------------------------
# libraries
library(tidyverse)      # Load 'Tidyverse' packages: ggplot2, dplyr, tidyr,
#                                 readr, purrr, tibble, stringr, forcats
library(glue)           # For string interpolation
library(here)           # A simpler way to find files
library(sf)             # Simple features for R
library(dataRetrieval)  # Retrieval functions for USGS and EPA hydro & wq data
# ---------------------------------------------------------
# Load sites in Great Plains ecoregion from local storage
sites_eco_only <- read_csv("data/sites_pk_eco_only.csv")
# drop sites with l.t 20 observations
sites_gt_20 <- sites_eco_only %>%
filter(count_nu >= 20) %>%
as.data.frame() %>%
select(-c(na_l1code:geometry))
# check for duplicates
duplicates <- sites_pk_eco_gt_20 %>%
filter(duplicated(.) | duplicated(., fromLast = TRUE))
knitr::opts_chunk$set(echo = TRUE)
# libraries
library(tidyverse)      # Load 'Tidyverse' packages: ggplot2, dplyr, tidyr,
#                                 readr, purrr, tibble, stringr, forcats
library(glue)           # For string interpolation
library(here)           # A simpler way to find files
library(dataRetrieval)  # Retrieval functions for USGS and EPA hydro & wq data
# get gages in GP ecoregion with gt 20 yrs of unregulated streamflow data
gages_eco <- read_csv("data/sites_pk_eco_only.csv")
gages_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
gages_unreg <- read_csv("sites_unreg")
View(sites_gt_20)
library(readr)
sites_all_in_bb <- read_csv("data/sites_all_in_bb.csv")
View(sites_all_in_bb)
library(readr)
data_pk_unreg_gt_20 <- read_csv("data/data_pk_unreg_gt_20.csv")
View(data_pk_unreg_gt_20)
# get gages in GP ecoregion with gt 20 yrs of unregulated streamflow data
sites_eco <- read_csv("data/sites_pk_eco_only.csv")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_unreg_gt_20")
sites_unreg_gt_20 <- read_csv("data/sites_unreg_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv")
knitr::opts_chunk$set(echo = TRUE)
# libraries
library(tidyverse)      # Load 'Tidyverse' packages: ggplot2, dplyr, tidyr,
#                                 readr, purrr, tibble, stringr, forcats
library(glue)           # For string interpolation
library(here)           # A simpler way to find files
library(dataRetrieval)  # Retrieval functions for USGS and EPA hydro & wq data
count_eco <- nrow(sites_eco)
sites_reg_or_lt_20 <- read_csv("data/sites_reg_or_lt_20.csv")
sites_in_bb <- read_csv("data/sites_all_peak_in_bb.csv")
sites_peak_in_bb <- read_csv("data/sites_all_peak_in_bb.csv")
sites_in_bb <- read_csv("data/sites_all_peak_in_bb.csv")
sites_in_bb <- read_csv("data/sites_all_in_bb.csv")
rm(sites_reg_or_lt_20)
sites_in_bb <- nrow(sites_in_bb)
sites_peak_in_bb <- nrow(sites_peak_in_bb)
count_in_bb <- nrow(sites_in_bb)
count_peak_in_bb <- nrow(sites_peak_in_bb)
count_eco <- nrow(sites_eco)
count_gt_20 <- nrow(sites_gt_20)
count_unreg_gt_20 <- nrow(sites_unreg_gt_20)
test <- tibble(count_in_bb, count_peak_in_bb, count_eco, count_gt_20, count_unreg_gt_20)
knitr::opts_chunk$set(echo = TRUE)
# libraries
library(tidyverse)      # Load 'Tidyverse' packages: ggplot2, dplyr, tidyr,
#                                 readr, purrr, tibble, stringr, forcats
library(glue)           # For string interpolation
library(here)           # A simpler way to find files
library(dataRetrieval)  # Retrieval functions for USGS and EPA hydro & wq data
# get gages in GP ecoregion with gt 20 yrs of unregulated streamflow data
sites_in_bb <- read_csv("data/sites_all_in_bb.csv")
sites_peak_in_bb <- read_csv("data/sites_all_peak_in_bb.csv")
sites_eco <- read_csv("data/sites_pk_eco_only.csv")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv")
sites_eco <- read_csv("data/sites_pk_eco_only.csv")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv")
count_in_bb <- nrow(sites_in_bb)
count_peak_in_bb <- nrow(sites_peak_in_bb)
count_eco <- nrow(sites_eco)
count_gt_20 <- nrow(sites_gt_20)
count_unreg_gt_20 <- nrow(sites_unreg_gt_20)
test <- tibble(count_in_bb, count_peak_in_bb, count_eco, count_gt_20, count_unreg_gt_20)
c("sites_in_bb", "sites_peak_in_bb", "sites_eco", "sites_gt_20", "sites_unreg_gt_20")
count_sites <- tibble(count_in_bb, count_peak_in_bb, count_eco, count_gt_20, count_unreg_gt_20)
sites <- tibble(c("sites_in_bb", "sites_peak_in_bb", "sites_eco", "sites_gt_20", "sites_unreg_gt_20"))
count_sites <- bind_col(sites, count_sites)
count_sites <- bind_cols(sites, count_sites)
View(count_sites)
sites <- tibble(
c("sites_in_bb", "sites_peak_in_bb", "sites_eco",
"sites_gt_20", "sites_unreg_gt_20"),
c("count_in_bb", "count_peak_in_bb", "count_eco",
"count_gt_20", "count_unreg_gt_20"),
)
# make vector of site names
site_names <- c("sites_in_bb", "sites_peak_in_bb", "sites_eco",
"sites_gt_20", "sites_unreg_gt_20")
# make vector of site names
site_name <- c("sites_in_bb", "sites_peak_in_bb", "sites_eco",
"sites_gt_20", "sites_unreg_gt_20")
knitr::opts_chunk$set(echo = TRUE)
# libraries
library(tidyverse)      # Load 'Tidyverse' packages: ggplot2, dplyr, tidyr,
#                                 readr, purrr, tibble, stringr, forcats
library(glue)           # For string interpolation
library(here)           # A simpler way to find files
library(dataRetrieval)  # Retrieval functions for USGS and EPA hydro & wq data
# get gages in GP ecoregion with gt 20 yrs of unregulated streamflow data
sites_in_bb <- read_csv("data/sites_all_in_bb.csv")
sites_peak_in_bb <- read_csv("data/sites_all_peak_in_bb.csv")
sites_eco <- read_csv("data/sites_pk_eco_only.csv")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv")
sites_eco <- read_csv("data/sites_pk_eco_only.csv")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv")
# make vector of site names
site_name <- c("sites_in_bb", "sites_peak_in_bb", "sites_eco",
"sites_gt_20", "sites_unreg_gt_20")
site_names <- as_tibble(site_name)
# make tibble of count names
count_names <- c("count_in_bb", "count_peak_in_bb", "count_eco",
"count_gt_20", "count_unreg_gt_20")
count_names <- as_tibble(count_name)
# make tibble of count names
count_name <- c("count_in_bb", "count_peak_in_bb", "count_eco",
"count_gt_20", "count_unreg_gt_20")
count_names <- as_tibble(count_name)
knitr::opts_chunk$set(echo = TRUE)
# libraries
library(tidyverse)      # Load 'Tidyverse' packages: ggplot2, dplyr, tidyr,
#                                 readr, purrr, tibble, stringr, forcats
library(glue)           # For string interpolation
library(here)           # A simpler way to find files
library(dataRetrieval)  # Retrieval functions for USGS and EPA hydro & wq data
# get gages in GP ecoregion with gt 20 yrs of unregulated streamflow data
sites_in_bb <- read_csv("data/sites_all_in_bb.csv")
sites_peak_in_bb <- read_csv("data/sites_all_peak_in_bb.csv")
sites_eco <- read_csv("data/sites_pk_eco_only.csv")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv")
sites_eco <- read_csv("data/sites_pk_eco_only.csv")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv")
knitr::opts_chunk$set(echo = TRUE)
# libraries
library(tidyverse)      # Load 'Tidyverse' packages: ggplot2, dplyr, tidyr,
#                                 readr, purrr, tibble, stringr, forcats
library(glue)           # For string interpolation
library(here)           # A simpler way to find files
library(dataRetrieval)  # Retrieval functions for USGS and EPA hydro & wq data
# get gages in GP ecoregion with gt 20 yrs of unregulated streamflow data
sites_in_bb <- read_csv("data/sites_all_in_bb.csv")
sites_peak_in_bb <- read_csv("data/sites_all_peak_in_bb.csv")
sites_eco <- read_csv("data/sites_pk_eco_only.csv")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv")
sites_eco <- read_csv("data/sites_pk_eco_only.csv")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv")
# make tibble of site names
site_name <- c("sites_in_bb", "sites_peak_in_bb", "sites_eco",
"sites_gt_20", "sites_unreg_gt_20")
site_names <- as_tibble(site_name)
# make tibble of count names
count_name <- c("count_in_bb", "count_peak_in_bb", "count_eco",
"count_gt_20", "count_unreg_gt_20")
count_names <- as_tibble(count_name)
# get lengths of counts
count_in_bb <- nrow(sites_in_bb)
count_peak_in_bb <- nrow(sites_peak_in_bb)
count_eco <- nrow(sites_eco)
count_gt_20 <- nrow(sites_gt_20)
count_unreg_gt_20 <- nrow(sites_unreg_gt_20)
# make tibble of lengths of counts
count_in_bb <- nrow(sites_in_bb)
site_count <- tibble(count_in_bb, count_peak_in_bb, count_eco, count_gt_20, count_unreg_gt_20)
View(site_count)
site_count <- tribble(count_in_bb, count_peak_in_bb, count_eco, count_gt_20, count_unreg_gt_20)
site_count <- as_tribble(count_in_bb, count_peak_in_bb, count_eco, count_gt_20, count_unreg_gt_20)
site_count <- tribble(count_in_bb, count_peak_in_bb, count_eco, count_gt_20, count_unreg_gt_20)
site_count <- tribble(~count, count_in_bb, count_peak_in_bb, count_eco, count_gt_20, count_unreg_gt_20)
View(site_count)
site_count <- bind_cols(count_names, site_count)
site_count <- bind_cols(site_names, site_count)
View(site_count)
knitr::opts_chunk$set(echo = TRUE)
# libraries
library(tidyverse)      # Load 'Tidyverse' packages: ggplot2, dplyr, tidyr,
#                                 readr, purrr, tibble, stringr, forcats
library(glue)           # For string interpolation
library(here)           # A simpler way to find files
library(dataRetrieval)  # Retrieval functions for USGS and EPA hydro & wq data
# get gages in GP ecoregion with gt 20 yrs of unregulated streamflow data
sites_in_bb <- read_csv("data/sites_all_in_bb.csv")
sites_peak_in_bb <- read_csv("data/sites_all_peak_in_bb.csv")
sites_eco <- read_csv("data/sites_pk_eco_only.csv")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv")
sites_eco <- read_csv("data/sites_pk_eco_only.csv")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv")
# make tibble of site names
site_name <- c("sites_in_bb", "sites_peak_in_bb", "sites_eco",
"sites_gt_20", "sites_unreg_gt_20")
site_names <- as_tibble(site_name)
# make tibble of count names
count_name <- c("count_in_bb", "count_peak_in_bb", "count_eco",
"count_gt_20", "count_unreg_gt_20")
count_names <- as_tibble(count_name)
# make tibble of lengths of counts
count_in_bb <- nrow(sites_in_bb)
count_peak_in_bb <- nrow(sites_peak_in_bb)
count_eco <- nrow(sites_eco)
count_gt_20 <- nrow(sites_gt_20)
count_unreg_gt_20 <- nrow(sites_unreg_gt_20)
site_count <- tribble(~count, count_in_bb, count_peak_in_bb, count_eco, count_gt_20, count_unreg_gt_20)
site_count <- bind_cols(site_names, site_count)
View(site_count)
sites_in_bb <- read_csv("data/sites_all_in_bb.csv")
sites_peak_in_bb <- read_csv("data/sites_all_peak_in_bb.csv")
sites_eco <- read_csv("data/sites_pk_eco_only.csv")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv")
sites_eco <- read_csv("data/sites_pk_eco_only.csv")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv")
sites_in_bb <- read_csv("data/sites_all_in_bb.csv") %>%
select(starts_with("dec"))
sites_in_bb <- read_csv("data/sites_all_in_bb.csv") %>%
select(starts_with("dec")) %>%
mutate(type = "all sites")
sites_eco <- read_csv("data/sites_pk_eco_only.csv")  %>%
select(starts_with("dec"))  %>%
mutate(ordinal_num = 3) %>%
mutate(type = "peak sites in ecoregion")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv")  %>%
select(starts_with("dec"))  %>%
mutate(ordinal_num = 4) %>%
mutate(type = "peak sites g.t. 20 yrs")
sites_in_bb <- read_csv("data/sites_all_in_bb.csv") %>%
select(starts_with("dec")) %>%
mutate(ordinal_num = 1) %>%
mutate(type = "all sites")
sites_peak_in_bb <- read_csv("data/sites_all_peak_in_bb.csv") %>%
select(starts_with("dec"))  %>%
mutate(ordinal_num = 2) %>%
mutate(type = "peak sites")
sites_eco <- read_csv("data/sites_pk_eco_only.csv") %>%
select(starts_with("dec"))  %>%
mutate(ordinal_num = 3) %>%
mutate(type = "peak sites in ecoregion")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv") %>%
select(starts_with("dec")) %>%
mutate(ordinal_num = 4) %>%
mutate(type = "peak sites g.t. 20 yrs")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv") %>%
select(starts_with("dec")) %>%
mutate(ordinal_num = 5) %>%
mutate(type = "unregulated peak sites g.t. 20 yrs")
scr1 <- anti_join(sites_gt_20, sites_unreg_gt_20)
sites_in_bb <- read_csv("data/sites_all_in_bb.csv") #%>%
sites_in_bb <- read_csv("data/sites_all_in_bb.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 1) %>%
mutate(type = "all sites")
sites_peak_in_bb <- read_csv("data/sites_all_peak_in_bb.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 2) %>%
mutate(type = "peak sites")
sites_eco <- read_csv("data/sites_pk_eco_only.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 3) %>%
mutate(type = "peak sites in ecoregion")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 4) %>%
mutate(type = "peak sites g.t. 20 yrs")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 5) %>%
mutate(type = "unregulated peak sites g.t. 20 yrs")
scr1 <- anti_join(sites_gt_20, sites_unreg_gt_20)
scr1 <- semi_join(sites_gt_20, sites_unreg_gt_20)
scr1 <- semi_join(sites_unreg_gt_20, sites_gt_20)
knitr::opts_chunk$set(echo = TRUE)
# libraries
library(tidyverse)      # Load 'Tidyverse' packages: ggplot2, dplyr, tidyr,
#                                 readr, purrr, tibble, stringr, forcats
library(glue)           # For string interpolation
library(here)           # A simpler way to find files
library(dataRetrieval)  # Retrieval functions for USGS and EPA hydro & wq data
# get gages in GP ecoregion with gt 20 yrs of unregulated streamflow data
sites_in_bb <- read_csv("data/sites_all_in_bb.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 1) %>%
mutate(type = "all sites")
sites_peak_in_bb <- read_csv("data/sites_all_peak_in_bb.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 2) %>%
mutate(type = "peak sites")
sites_eco <- read_csv("data/sites_pk_eco_only.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 3) %>%
mutate(type = "peak sites in ecoregion")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 4) %>%
mutate(type = "peak sites g.t. 20 yrs")
sites_unreg_gt_20 <- read_csv("data/sites_reg_or_lt_20.csv")
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 5) %>%
mutate(type = "unregulated peak sites g.t. 20 yrs")
sites_unreg_gt_20 <- read_csv("data/sites_reg_or_lt_20.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 5) %>%
mutate(type = "unregulated peak sites g.t. 20 yrs")
scr1 <- bind_cols(sites_unreg_gt_20, sites_gt_20)
scr1 <- bind_rows(sites_unreg_gt_20, sites_gt_20)
knitr::opts_chunk$set(echo = TRUE)
# libraries
library(tidyverse)      # Load 'Tidyverse' packages: ggplot2, dplyr, tidyr,
#                                 readr, purrr, tibble, stringr, forcats
library(glue)           # For string interpolation
library(here)           # A simpler way to find files
library(dataRetrieval)  # Retrieval functions for USGS and EPA hydro & wq data
# get gages in GP ecoregion with gt 20 yrs of unregulated streamflow data
sites_in_bb <- read_csv("data/sites_all_in_bb.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 1) %>%
mutate(type = "all sites")
sites_peak_in_bb <- read_csv("data/sites_all_peak_in_bb.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 2) %>%
mutate(type = "peak sites")
sites_eco <- read_csv("data/sites_pk_eco_only.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 3) %>%
mutate(type = "peak sites in ecoregion")
sites_gt_20 <- read_csv("data/sites_pk_eco_gt_20.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 4) %>%
mutate(type = "peak sites g.t. 20 yrs")
sites_unreg_gt_20 <- read_csv("data/sites_reg_or_lt_20.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 5) %>%
mutate(type = "unregulated peak sites g.t. 20 yrs")
sites_unreg_gt_20 <- read_csv("data/sites_unreg_gt_20.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 5) %>%
mutate(type = "unregulated peak sites g.t. 20 yrs")
knitr::opts_chunk$set(echo = TRUE)
# libraries
library(tidyverse)      # Load 'Tidyverse' packages: ggplot2, dplyr, tidyr,
#                                 readr, purrr, tibble, stringr, forcats
library(glue)           # For string interpolation
library(here)           # A simpler way to find files
library(dataRetrieval)  # Retrieval functions for USGS and EPA hydro & wq data
# get gages in GP ecoregion with gt 20 yrs of unregulated streamflow data
sites_in_bb <- read_csv("data/sites_all_in_bb.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 1) %>%
mutate(type = "all sites")
sites_peak_in_bb <- read_csv("data/sites_all_peak_in_bb.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 2) %>%
mutate(type = "peak sites")
sites_eco <- read_csv("data/sites_pk_eco_only.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 3) %>%
mutate(type = "peak sites in ecoregion")
sites_gt_20 <- read_csv("data/sites_reg_or_lt_20.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 4) %>%
mutate(type = "peak sites g.t. 20 yrs")
sites_unreg_gt_20 <- read_csv("data/sites_unreg_gt_20.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 5) %>%
mutate(type = "unregulated peak sites g.t. 20 yrs")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 5) %>%
mutate(type = "unregulated peak sites g.t. 20 yrs")
scr1 <- bind_rows(sites_unreg_gt_20, sites_gt_20)
rm(sites_unreg_gt_20, sites_gt_20)
scr2 <- anti_join(sites_eco, scr1)
scr3 <- anti_join(sites_peak_in_bb, scr2)
rm(sites_peak_in_bb, scr2)
rm(sites_eco, scr1)
scr3 <- anti_join(sites_peak_in_bb, scr2) %>%
select(-dec_coord_datum_cd)
knitr::opts_chunk$set(echo = TRUE)
# libraries
library(tidyverse)      # Load 'Tidyverse' packages: ggplot2, dplyr, tidyr,
#                                 readr, purrr, tibble, stringr, forcats
library(glue)           # For string interpolation
library(here)           # A simpler way to find files
library(dataRetrieval)  # Retrieval functions for USGS and EPA hydro & wq data
# get gages in GP ecoregion with gt 20 yrs of unregulated streamflow data
sites_in_bb <- read_csv("data/sites_all_in_bb.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 1) %>%
mutate(type = "all sites")
sites_peak_in_bb <- read_csv("data/sites_all_peak_in_bb.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 2) %>%
mutate(type = "peak sites")
sites_eco <- read_csv("data/sites_pk_eco_only.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 3) %>%
mutate(type = "peak sites in ecoregion")
sites_gt_20 <- read_csv("data/sites_reg_or_lt_20.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 4) %>%
mutate(type = "peak sites g.t. 20 yrs")
sites_unreg_gt_20 <- read_csv("data/sites_pk_unreg_gt_20.csv") %>%
select(site_no, starts_with("dec")) %>%
mutate(ordinal_num = 5) %>%
mutate(type = "unregulated peak sites g.t. 20 yrs")
scr1 <- bind_rows(sites_unreg_gt_20, sites_gt_20)
rm(sites_unreg_gt_20, sites_gt_20)
scr2 <- anti_join(sites_eco, scr1)
rm(sites_eco, scr1)
scr3 <- anti_join(sites_peak_in_bb, scr2) %>%
select(-dec_coord_datum_cd)
rm(sites_peak_in_bb, scr2)
scr4 <- anti_join(sites_in_bb, scr3)
rm(sites_in_bb)
rm(sites_in_bb, scr3)
write_csv("data/site_types")
write_csv("data/site_types.csv")
write_csv(scr4, "data/site_types.csv")
