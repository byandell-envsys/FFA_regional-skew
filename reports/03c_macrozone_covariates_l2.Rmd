---
title: "03c Macrozone Covariates from Level II Ecoregions"
author: "CJ Tinant"
date: 2024-04-20
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Overview

This script derives a categorical macroregional covariate ("macrozone") for the Great Plains, based on EPA Level II ecoregions. Output is saved in projected CRS (EPSG:5070) for modeling.

---

## üì• Inputs

- `NA_eco_lev2_GreatPlains_geographic.gpkg` ‚Äì Level II polygons (North America)
- `NA_eco_lev1_GreatPlains_geographic.gpkg` ‚Äì Level I polygons (used to filter CONUS)

---

## üß≠ Method

1. Read and validate both Level I and Level II ecoregion files
2. Filter to `na_l1name == "GREAT PLAINS"`
3. Use `st_filter()` to clip Level II polygons to CONUS
4. Classify Level II regions into one of four macrozones:
   - **Tallgrass**
   - **Mixedgrass**
   - **Shortgrass**
   - **Semidesert**
5. Drop geometry artifacts (`shape_area`, `shape_leng`, etc.)
6. Reproject to **EPSG:5070**
7. Calculate area (m¬≤)
8. Export to: `data/processed/spatial/gp_macrozone_derived_5070.gpkg`

---

## üì§ Outputs

- Clean GeoPackage with macrozone column and projected geometry
- Optional `.csv` lookup table for reproducibility

---

## üìù Notes

- Join is based on `na_l2name`
- Output is ready for use in modeling regional skew
- This step aligns with scripts in `R/01_download/03c_macrozone_covariates_l2.R`
